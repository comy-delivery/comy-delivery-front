<div class="container mt-4">

	<!-- ALERTAS -->
	@if(successMessage) {
		<div class="alert alert-success alert-dismissible fade show" role="alert">
			<i class="bi bi-check-circle me-2"></i>{{ successMessage }}
			<button type="button" class="btn-close" (click)="successMessage = ''"></button>
		</div>
	}

	@if(errorMessage) {
		<div class="alert alert-danger alert-dismissible fade show" role="alert">
			<i class="bi bi-exclamation-triangle me-2"></i>{{ errorMessage }}
			<button type="button" class="btn-close" (click)="errorMessage = ''"></button>
		</div>
	}

	<div class="card shadow rounded-4">
		<div class="card-header bg-white d-flex justify-content-between align-items-center py-3">
			<h4 class="mb-0">
				<i class="bi bi-shop me-2"></i>Restaurantes Cadastrados
			</h4>
			<button class="btn btn-outline-secondary" routerLink="/admin">
				<i class="bi bi-arrow-left me-2"></i>Voltar ao Cadastro
			</button>
		</div>

		<div class="card-body">
			<!-- LOADING -->
			@if(isLoading) {
				<div class="text-center py-5">
					<div class="spinner-border text-primary" role="status">
						<span class="visually-hidden">Carregando...</span>
					</div>
					<p class="mt-3 text-muted">Carregando restaurantes...</p>
				</div>
			}

			<!-- LISTA VAZIA -->
			@else if(restaurantes.length === 0) {
				<div class="text-center py-5">
					<i class="bi bi-inbox display-1 text-muted"></i>
					<p class="mt-3 text-muted">Nenhum restaurante cadastrado ainda.</p>
					<button class="btn btn-primary mt-2" routerLink="/painel-admin">
						<i class="bi bi-plus-circle me-2"></i>Cadastrar Primeiro Restaurante
					</button>
				</div>
			}

			<!-- TABELA DE RESTAURANTES -->
			@else {
				<div class="table-responsive">
					<table class="table table-hover align-middle">
						<thead class="table-light">
							<tr>
								<th class="text-center" style="width: 80px;">#</th>
								<th>Nome do Restaurante</th>
								<th>Username</th>
								<th>Categoria</th>
								<th>Status</th>
								<th class="text-center" style="width: 120px;">Ações</th>
							</tr>
						</thead>
						<tbody>
							@for(restaurante of restaurantes; track restaurante.id) {
								<tr>
									<td class="text-center">
										<strong class="text-primary">{{ restaurante.id }}</strong>
									</td>
									<td>
										<div class="d-flex align-items-center">
											<i class="bi bi-shop me-2 text-primary"></i>
											<strong>{{ restaurante.nmRestaurante }}</strong>
										</div>
									</td>
									<td>
										<span class="badge bg-secondary">{{ restaurante.username }}</span>
									</td>
									<td>
										<span class="badge bg-info">{{ restaurante.categoria || 'Não informado' }}</span>
									</td>
									<td>
										@if(restaurante.isAtivo) {
											<span class="badge bg-success">
												<i class="bi bi-check-circle me-1"></i>Ativo
											</span>
										} @else {
											<span class="badge bg-danger">
												<i class="bi bi-x-circle me-1"></i>Inativo
											</span>
										}
									</td>
									<td class="text-center">
										<button 
											class="btn btn-sm btn-outline-danger"
											(click)="confirmarExclusao(restaurante)"
											[disabled]="excluindoId === restaurante.id"
											title="Excluir restaurante">
											@if(excluindoId === restaurante.id) {
												<span class="spinner-border spinner-border-sm"></span>
											} @else {
												<i class="bi bi-trash"></i>
											}
										</button>
									</td>
								</tr>
							}
						</tbody>
					</table>
				</div>

				<!-- TOTAL -->
				<div class="mt-3 text-muted text-center">
					<small>Total de {{ restaurantes.length }} restaurante(s) ativo(s)</small>
				</div>
			}
		</div>
	</div>

</div>

<!-- MODAL DE CONFIRMAÇÃO -->
@if(restauranteParaExcluir) {
	<div class="modal fade show d-block" tabindex="-1" style="background: rgba(0,0,0,0.5);">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header bg-danger text-white">
					<h5 class="modal-title">
						<i class="bi bi-exclamation-triangle me-2"></i>Confirmar Exclusão
					</h5>
					<button type="button" class="btn-close btn-close-white" (click)="cancelarExclusao()"></button>
				</div>
				<div class="modal-body">
					<p class="mb-2">Tem certeza que deseja excluir o restaurante:</p>
					<p class="mb-0">
						<strong class="text-danger">{{ restauranteParaExcluir.nmRestaurante }}</strong>
						<span class="text-muted ms-2">({{ restauranteParaExcluir.username }})</span>
					</p>
					<p class="mt-3 text-muted small">
						<i class="bi bi-info-circle me-1"></i>Esta ação não pode ser desfeita.
					</p>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" (click)="cancelarExclusao()">
						Cancelar
					</button>
					<button type="button" class="btn btn-danger" (click)="excluirRestaurante()">
						<i class="bi bi-trash me-2"></i>Sim, Excluir
					</button>
				</div>
			</div>
		</div>
	</div>
}